<div class="resultados-container container py-5">
  <h2 class="gradient-text mb-4">🏆 Resultados Globales</h2>

  <div *ngIf="loading()" class="loading-container">
    <div class="spinner"></div>
    <span>Cargando resultados...</span>
  </div>

  <div *ngIf="!loading()" class="resultados-content">
    <div class="filtro-juegos mb-5">
      <label for="juego-selector"><i class="bi bi-funnel-fill"></i> Filtrar por juego:</label>
      <select id="juego-selector" class="form-select" [(ngModel)]="juegoSeleccionado" (change)="filtrarResultados()">
        <option value="ahorcado">Ahorcado</option>
        <option value="mayorMenor">Mayor o Menor</option>
        <option value="preguntados">Preguntados</option>
        <option value="adivinaBandera">Adivina la Bandera</option>
      </select>
    </div>

    <div class="tabla-juego" *ngIf="mostrarJuego('ahorcado')">
      <h3>🪓 Ahorcado</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Jugador</th>
            <th>Palabra</th>
            <th>¿Ganó?</th>
            <th>Tiempo (s)</th>
            <th>Intentos</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let r of ahorcado()">
            <td data-label="Jugador">{{ r.username }}</td>
            <td data-label="Palabra">{{ r.word }}</td>
            <td data-label="¿Ganó?">{{ r.won ? '✅' : '❌' }}</td>
            <td data-label="Tiempo (s)">{{ (r.time_ms / 1000) | number:'1.0-1' }}</td>
            <td data-label="Intentos">{{ r.guesses }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="tabla-juego" *ngIf="mostrarJuego('mayorMenor')">
      <h3>🔼🔽 Mayor o Menor</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Jugador</th>
            <th>Aciertos</th>
            <th>Rondas</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let r of mayorMenor()">
            <td data-label="Jugador">{{ r.username }}</td>
            <td data-label="Aciertos">{{ r.correct_count }}</td>
            <td data-label="Rondas">{{ r.total_rounds }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="tabla-juego" *ngIf="mostrarJuego('preguntados')">
      <h3>❓ Preguntados</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Jugador</th>
            <th>Tema</th>
            <th>Aciertos</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let r of preguntados()">
            <td data-label="Jugador">{{ r.username }}</td>
            <td data-label="Tema">{{ r.topic }}</td>
            <td data-label="Aciertos">{{ r.correct_answers }}</td>
            <td data-label="Total">{{ r.total_questions }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="tabla-juego" *ngIf="mostrarJuego('adivinaBandera')">
      <h3>🗺️ Adivina la Bandera</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Jugador</th>
            <th>Puntuación</th>
            <th>Aciertos</th>
            <th>Intentos</th>
            <th>Tiempo (s)</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let r of adivinaBandera()">
            <td data-label="Jugador">{{ r.username }}</td>
            <td data-label="Puntuación">{{ r.score }}</td>
            <td data-label="Aciertos">{{ r.flags_guessed }}</td>
            <td data-label="Intentos">{{ r.total_attempts }}</td>
            <td data-label="Tiempo (s)">{{ (r.time_taken_ms / 1000) | number:'1.0-1' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>